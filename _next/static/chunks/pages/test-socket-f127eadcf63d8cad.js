(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[424],{7144:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/test-socket",function(){return e(15)}])},15:function(n,t,e){"use strict";e.r(t),e.d(t,{default:function(){return r}});var o=e(5893),c=e(7294),i=e(7642);function r(){let[n,t]=(0,c.useState)(!1),[e,r]=(0,c.useState)([]),[s,a]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let n=n=>{r(t=>[...t,"".concat(new Date().toLocaleTimeString(),": ").concat(n)])},e=async function(){try{n("尝试连接Socket.IO..."),await fetch("/api/socket");let e=(0,i.io)(void 0,{path:"/api/socket",transports:["polling","websocket"]});return e.on("connect",()=>{n("连接成功! ID: ".concat(e.id)),t(!0),a(null),e.emit("get-funding-rates")}),e.on("connected",t=>{n("收到连接确认: ".concat(JSON.stringify(t)))}),e.on("funding-rates",t=>{var e;n("收到资金费率数据: ".concat((null===(e=t.data)||void 0===e?void 0:e.length)||0,"条记录"))}),e.on("disconnect",()=>{n("连接断开"),t(!1)}),e.on("connect_error",t=>{let e="连接错误: ".concat(t.message);n(e),a(e)}),()=>{n("关闭连接"),e.disconnect()}}catch(e){let t="初始化错误: ".concat(e.message);n(t),a(t)}}();return()=>{e&&e()}},[]),(0,o.jsxs)("div",{style:{padding:"20px",fontFamily:"monospace"},children:[(0,o.jsx)("h1",{children:"Socket.IO 连接测试"}),(0,o.jsxs)("div",{style:{padding:"10px",borderRadius:"5px",backgroundColor:n?"#4caf50":"#f44336",color:"white",marginBottom:"20px"},children:["状态: ",n?"已连接":"未连接",s&&(0,o.jsx)("div",{style:{marginTop:"10px",fontSize:"14px"},children:s})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{children:"连接日志:"}),(0,o.jsx)("div",{style:{height:"400px",overflow:"auto",backgroundColor:"#f5f5f5",padding:"10px",borderRadius:"5px"},children:e.map((n,t)=>(0,o.jsx)("div",{style:{marginBottom:"5px"},children:n},t))})]}),(0,o.jsx)("div",{style:{marginTop:"20px"},children:(0,o.jsx)("a",{href:"/",style:{color:"blue",textDecoration:"underline"},children:"返回主页"})})]})}}},function(n){n.O(0,[642,888,774,179],function(){return n(n.s=7144)}),_N_E=n.O()}]);